/*!
 * Posts Table Pro 2.3.3
 * Copyright 2020 Barn2 Plugins
 */
"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}(function(c,e){var i={message:null,overlayCSS:{background:"#fff",opacity:.7}};function n(a){return function(t,e){"class"===t?a.addClass(e):a.attr(t,e)}}function l(t){t&&t.length&&("undefined"!=typeof WPPlaylistView&&t.find(".wp-playlist").filter(function(){return 0===c(".mejs-container",this).length}).each(function(){return new WPPlaylistView({el:this})}),"wp"in e&&"mediaelement"in e.wp&&c(e.wp.mediaelement.initialize),c.fn.fitVids&&t.fitVids())}function s(){return"select2"in c.fn&&posts_table_params.enable_select2}function t(t){this.$table=t,this.id=t.attr("id"),this.dataTable=null,this.config=null,this.ajaxData=[],this.hasAdminBar=0<c("#wpadminbar").length,this.$filters=[],this.$tableWrapper=[],this.$pagination=[],this.$tableControls=[],t.on("draw.dt",{table:this},o).on("init.dt",{table:this},p).on("page.dt",{table:this},h).on("processing.dt",{table:this},u).on("responsive-display.dt",{table:this},g).on("xhr.dt",{table:this},a),c(e).on("load",{table:this},v),t.addClass("loading").css("visibility","visible")}function a(t,e,a,i){var n=t.data.table;null!==a&&"data"in a&&c.isArray(a.data)&&(n.ajaxData=a.data),n.$table.trigger("lazyload.ptp",[n])}function r(t){var e=c(this),a=t.data.table,i=a.getDataTable(),n=e.closest("td");n.hasClass("child")&&(n=e.closest("[data-dt-column]",n));var r=i.column(n.get(0));if(!r.length)return!0;var l=c(r.header());if(!l.data("clickFilter"))return!0;t.preventDefault();var s=e.text(),o=l.data("name"),d=a.$filters&&a.$filters.length?a.$filters.filter('[data-column="'+o+'"]'):[];return d.length&&(i.column(d.first().data("searchColumn")+":name").search(""),c("option",d).filter(function(){return c.trim(c(this).text().replace("–",""))===s}).prop("selected",!0).trigger("change",[!0])),a.config.serverSide?r.search(s).draw():(s="(^|, )"+c.fn.dataTable.util.escapeRegex(s)+"(, |$)",r.search(s,!0,!1).draw()),a.scrollToTop(),!1}function o(t){var e=t.data.table;e.config.serverSide&&e.processAjaxData(),!e.config.serverSide&&e.$table.hasClass("loading")||l(e.$table),e.showHidePagination(),e.$table.trigger("draw.ptp",[e])}function d(t,e){var a=c(this),i=t.data.table;if(e)return!0;var n=a.val(),r=a.data("column"),l=i.getDataTable().column(a.data("searchColumn")+":name");if(i.config.serverSide)l.search(n).draw();else{var s=n?"(^| )"+c.fn.dataTable.util.escapeRegex(n)+"( |$)":"";l.search(s,!0,!1).draw()}var o=i.$filters.filter('[data-column="'+r+'"]'),d=i.$filters.not(o);o.not(a[0]).val(n).trigger("change",[!0]),i.config.serverSide||d.each(function(){i.refreshFilterItems(c(this))})}function p(t){var e=t.data.table;e.$tableWrapper=e.$table.parent(),e.$pagination=e.$tableWrapper.find(".dataTables_paginate"),e.$tableControls=e.$tableWrapper.find(".posts-table-controls"),e.initFilters().initSelect2().initResetButton().initSearchOnClick().initPhotoswipe().showHidePagination(),!e.config.serverSide&&c.fn.fitVids&&e.$table.fitVids(),e.$table.removeClass("loading").trigger("init.ptp",[e])}function f(t){t.preventDefault();var e=c(".pswp")[0],a=c(t.target).closest(".posts-table-gallery__image"),n=[];0<a.length&&a.each(function(t,e){var a=c(e).find("img"),i={src:a.attr("data-large_image"),w:a.attr("data-large_image_width"),h:a.attr("data-large_image_height"),title:a.attr("data-caption")&&a.attr("data-caption").length?a.attr("data-caption"):a.attr("title")};n.push(i)});new PhotoSwipe(e,PhotoSwipeUI_Default,n,{index:0,shareEl:!1,closeOnScroll:!1,history:!1,hideAnimationDuration:0,showAnimationDuration:0}).init()}function h(t){t.data.table.scrollToTop()}function u(t,e,a){a?t.data.table.$table.block(i):t.data.table.$table.unblock()}function b(t){t.preventDefault();var e=t.data.table,a=e.getDataTable();e.$table.find("tr.child").remove(),e.$table.find("tr.parent").removeClass("parent"),a.columns('th[data-searchable="true"]').search("");var i=e.$table.attr("data-order");if(i.length){var n=i.replace(/[\[\]\" ]+/g,"").split(",");2===n.length&&a.order(n)}e.$filters.length&&(e.$filters.val("").trigger("change",[!0]),e.config.serverSide||e.$filters.each(function(){e.refreshFilterItems(c(this))}));var r="search"in e.config&&"search"in e.config.search?e.config.search.search:"";a.search(r).page.len(e.config.pageLength).draw(!0),s()&&e.$tableControls.find(".dataTables_length select").trigger("change")}function g(t,e,a,i,n){if(i&&void 0!==a.child()){l(a.child());var r=t.data.table;r.$table.trigger("responsive-display.ptp",[r,a.child()])}}function v(t){var e=t.data.table;e.getDataTable().columns.adjust().responsive.recalc(),e.$table.trigger("load.ptp",[e])}t.prototype.buildConfig=function(){var t={retrieve:!0,responsive:!0,processing:!0,orderMulti:!1,language:posts_table_params.language},e=this.$table.data("config");return e&&(t=c.extend(!0,{},t,e)),-1!==t.language.info.indexOf(posts_table_params.language.totalsPlural)&&(t.infoCallback=function(t,e,a,i,n,r){return r&&1===n?r.replace(posts_table_params.language.totalsPlural,posts_table_params.language.totalsSingle):r}),t.serverSide&&"ajax_url"in posts_table_params&&(t.deferRender=!0,t.ajax={url:posts_table_params.ajax_url,type:"POST",data:{table_id:this.id,action:posts_table_params.ajax_action,_ajax_nonce:posts_table_params.ajax_nonce},xhrFields:{withCredentials:!0}}),"responsive"in t&&"object"===_typeof(t.responsive)&&"details"in t.responsive&&"display"in t.responsive.details&&("child_row_visible"===t.responsive.details.display?(t.responsive.details.display=c.fn.dataTable.Responsive.display.childRowImmediate,t.responsive.details.renderer=c.fn.dataTable.Responsive.renderer.listHidden()):"modal"===t.responsive.details.display&&(t.responsive.details.display=c.fn.dataTable.Responsive.display.modal(),t.responsive.details.renderer=function(r){return r=c.extend({tableClass:""},r),function(e,t,a){var i=c.map(a,function(t){return e.column(t.columnIndex).visible()?'<tr data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><td>'+(t.title?t.title+":":"")+"</td> <td>"+t.data+"</td></tr>":""}).join(""),n=c('<table class="'+r.tableClass+' dtr-details" width="100%"/>').append(i);return l(n),n}}({tableClass:posts_table_params.table_class}))),"lang_url"in posts_table_params&&(t.language={url:posts_table_params.lang_url}),t},t.prototype.getCurrentFilterItems=function(t){var e=this.$table.data("filters"),a=t.data("column");if(!(e&&a in e))return null;var i=e[a].terms;if(!i)return[];if(!this.config.serverSide){var n=this.getDataTable().column(t.data("searchColumn")+":name",{search:"applied"}).data();if(n.any())i=function t(e,a){for(var i,n=JSON.parse(JSON.stringify(e)),r=n.length-1;0<=r;r--)(i=n[r]).hasOwnProperty("children")&&(i.children=t(i.children,a),0===i.children.length&&delete i.children),-1!==a.indexOf(i.slug)||i.hasOwnProperty("children")||n.splice(r,1);return n}(i,n.join(" ").split(" "))}return i},t.prototype.getDataTable=function(){return this.dataTable||this.init(),this.dataTable},t.prototype.init=function(){this.config=this.buildConfig(),this.dataTable=this.$table.DataTable(this.config)},t.prototype.initFilters=function(){var t=this,e=t.$table.data("filters");if(!e)return t;var a=c('<div class="posts-table-select-filters" id="'+t.id+'_select_filters" />'),i=0;for(var n in posts_table_params.language.filterBy&&a.append('<label class="filter-label">'+posts_table_params.language.filterBy+"</label>"),e){var r={name:"ptp_filter_"+n,"data-tax":e[n].taxonomy,"data-column":n,"data-search-column":n+"_hfilter","aria-label":e[n].heading,"data-placeholder":e[n].heading};e[n].class&&(r.class=e[n].class);var l=c("<select/>").attr(r);t.refreshFilterItems(l),l.children().length<=1||(l.on("change",{table:t},d).appendTo(a),i++)}if(0<i){var s=t.$tableControls.find(".dataTables_filter");s.length?a.prependTo(s.closest(".posts-table-controls")):a.prependTo(t.$tableControls.filter(".posts-table-above"))}return t.$filters=t.$tableControls.find(".posts-table-select-filters select"),t},t.prototype.initPhotoswipe=function(){return"undefined"==typeof PhotoSwipe||this.$table.on("click",".posts-table-gallery__image a",f),this},t.prototype.initResetButton=function(){var t=this;if(!t.config.resetButton)return t;var e=c('<div class="posts-table-reset"><a class="reset" href="#">'+posts_table_params.language.resetButton+"</a></div>").on("click","a",{table:t},b),a=t.$tableControls.filter(".posts-table-above").children(".posts-table-select-filters, .dataTables_length, .dataTables_filter").eq(0);return a.length?a.append(e):t.$tableControls.filter(".posts-table-above").prepend(e),t},t.prototype.initSearchOnClick=function(){return this.config.clickFilter&&this.$table.on("click","a",{table:this},r),this},t.prototype.initSelect2=function(){var t=this;if(!s())return t;var e={dropdownCssClass:"posts-table-dropdown",dropdownParent:t.$tableWrapper};return t.$filters.length&&t.$filters.select2(Object.assign(e,{minimumResultsForSearch:5})),t.$tableControls.find(".dataTables_length select").select2(Object.assign(e,{minimumResultsForSearch:-1})),t},t.prototype.processAjaxData=function(){var t=this;if(t.config.serverSide&&t.ajaxData.length){for(var e=t.$table.find("tbody tr"),a=0;a<t.ajaxData.length;a++)"__attributes"in t.ajaxData[a]&&e.eq(a).length&&c.each(t.ajaxData[a].__attributes,n(e.eq(a)));return t}},t.prototype.refreshFilterItems=function(t){var e=this.$table.data("filters"),a=t.data("column"),i=t.val();e&&a in e&&(t.empty(),c('<option value="" />').text(e[a].heading).prependTo(t),function r(l,t,s){s=void 0!==s?s:0,c.each(t,function(t,e){var a=e.name,i="slug"in e?e.slug:a,n="";s&&(n=Array(2*s+1).join(" ")+"– "),l.append('<option value="'+i+'">'+n+a+"</option>"),"children"in e&&r(l,e.children,s+1)})}(t,this.getCurrentFilterItems(t)),t.val(i))},t.prototype.scrollToTop=function(){var t=this.config.scrollOffset;if(!1!==t&&!isNaN(t)){var e=this.$tableWrapper.offset().top-t;this.hasAdminBar&&(e-=32),c("html,body").animate({scrollTop:e},300)}return this},t.prototype.showHidePagination=function(){var t=this;if(t.$pagination.length){var e=t.getDataTable().page.info();e&&e.pages<=1?t.$pagination.hide(0):t.$pagination.show()}return t},c.fn.postsTable=function(){return this.each(function(){new t(c(this)).init()})},c(function(){"DataTable"in c.fn&&c.fn.DataTable.ext&&(c.fn.DataTable.ext.errMode="throw"),c("."+posts_table_params.table_class).postsTable()})})(jQuery,window,document);